<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      FreeBSD: Running 'make installworld' from CD &middot; PapaScott
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.9.0/css/lightbox.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
  <link rel="stylesheet" href="/public/css/ps.css">

  <!-- Icons -->
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed/index.xml">

  

</head>


  <body class="theme-base-08" >

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p><a href="/">PapaScott</a> is a personal weblog by Scott Hanson.</p>
  </div>
<!-- Jquery loads content of sidebar div, see default.html -->
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">PapaScott</a>
            <small>I like big blogs and I cannot lie!</small>
          </h3>
        </div>
      </div>

      <div class="container content">


        <div class="post">
  <h1 class="post-title">FreeBSD: Running 'make installworld' from CD</h1>
  <span class="post-date">20 Aug 2003</span>
  <p>Sorry, non-tech folks. This is a sysadmin voodoo post.</p>
<p>I maintain several FreeBSD machines. When a security alert is issued, the standard procedure is to update the source for your release with cvs or cvsup, then recompile and reinstall the system with 'make buildworld' and 'make installworld'. It's also fairly standard procedure to <a title="Tracking for Multiple Machines" href="http://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/small-lan.html">'make buildworld' on one machine</a>, then export /usr/src and /usr/obj read-only via NFS to do installworld on the target machine. </p>
<p>However, my FreeBSD machines are behind a firewall inside a DMZ. I can't mount NFS through the firewall, and I don't really want to be compiling systems on underpowered small-disk single-purpose machines in a DMZ. At first, I used installation CDs to update major versions. This is not very flexible and may not include the latest security patches. Lately I've been plugging the DMZ machines temporarily into the LAN to update over NFS. This is unelegant and may damage the cables and switches (not to mention my fingers) when unplugging.</p>
<p>However, through trial and error (I haven't seen this tip anywhere), I figured out that after running 'make buildworld' on the build machine, I can burn /usr/src and /usr/obj on CD, and then run 'make installworld' from it on the target machines. The trick is you can't just have symlinks from /usr/src and /usr/obj to the CD. You've got to have actual mounts. In this case, <a title="mount_null (8)" href="http://www.freebsd.org/cgi/man.cgi?query=mount_null&amp;sektion=8&amp;apropos=0&amp;manpath=FreeBSD+4.8-RELEASE">null mounts</a> work wonders. (Ignore the bit about 'not fully supported' and 'this doesn't work'.) If the CD is mounted on /cdrom, then:<br />
<code>mount -t null /cdrom/src /usr/src<br />
mount -t null /cdrom/obj /usr/obj</code></p>
<p>You can then cd /usr/src and do your make installs and mergemaster. If you're really brave, you can do this while your services are running (single-user mode is for wimps), and then your only downtime is the reboot.</p>

</div>
<div>
  
    <span class="post-date">
    Previous Post: <a href="/archives/2003/08/20/inessentialcom-how-to-deal-with-broken-feeds/">inessential.com: How to deal with broken feeds</a></span>
  
  
    <span class="post-date">
    Next Post: <a href="/archives/2003/08/21/schill-out/">Schill Out</a></span>
  
</div>
<div class="related" id="related">
<!-- Jquery loads content of related div, see default.html -->
</div>

        
<!-- Add Disqus comments. -->
<div id="disqus_thread"></div>
<script type="text/javascript">
if(location.hostname.match('papascott')){
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'papascott'; // required: replace example with your forum shortname
  var disqus_identifier = "/archives/2003/08/20/freebsd-running-make-installworld-from-cd/";

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
  }
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/zepto/1.1.4/zepto.min.js"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.9.0/js/lightbox-plus-jquery.js"></script>
    
    <script>
      $( "#sidebar" ).load( "/includes/sidebar.html" );
      $( "#related" ).load( "/includes/related.html" );
      
    </script>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>
  </body>
</html>
